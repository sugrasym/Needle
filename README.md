Introduction
==============================================================================================================================
Needle is a C# class library that uses data annotations to allow you to define searchable properties on your classes. The primary purpose of Needle is to cut down time writing query conditions when searching through collections of your objects. For example, taking an Address generated by Entity Framework and mapping its properties like Line 1, Line 2, City, etc to a searchable aggregate.

Why?
==============================================================================================================================
No one likes to write more code than they need to. They also don't want helper/utility classes to be redundant and lengthy. Needle lets you group all the possible fields to search on and execute a search en masse.

How?
==============================================================================================================================
Needle uses data annotations and reflection to do mapping. Data annotations are a powerful C# feature which allows you to decorate a property with meta data that other parts of the application, or libraries the application uses, can read.

Needle uses Haystack attributes. The Haystack attribute specifies if a field is searchable and under what conditions should it be searched. For example, using a basic Address:

<pre>
<code>
public class Address 
{
    public int AddressId { get; set; }
    public string AddressLine1 { get; set; }
    public string AddressLine2 { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string Country { get; set; }
    public string ZipCode { get; set; }
    public string County { get; set; }
    public double Longitude { get; set; }
    public double Latitude { get; set; }
}
</code>
</pre>

We could decorate (or attach metadata) to this class so that its text properties could be searched, like so:
<pre>
<code>
public class Address 
{
    ...

    [Haystack]
    public string AddressLine1 { get; set; }
    [Haystack]
    public string AddressLine2 { get; set; }
    [Haystack]
    public string City { get; set; }
    [Haystack]
    public string State { get; set; }
    [Haystack]
    public string Country { get; set; }
    [Haystack]
    public string ZipCode { get; set; }
    [Haystack]
    public string County { get; set; }

    ...
}
</code>
</pre>

Say you wanted to filter down your Address collection into just United States Addresses (terrible example, TODO come up with better example)
<pre>
<code>
[MetadataType(typeof(UsAddress.MetaData))]
public class UsAddress : Address
{
    internal class MetaData
    {
        ...
	    
        [Haystack(isVisible: @"Country.Equals("USA")")]
        public string AddressLine1 { get; set; }
	    
        ...
    }
}
</code>
</pre>

Or, if you wanted to modify what is queried, you can use the Haystack attribute's QueryRender parameter. Maybe you don't want to search by a long zip/postal code, you could do this:
<pre>
<code>
public class Address
{
    ...
    
    [Haystack(queryRender: @"ZipCode.Substring(0,5)")]
    public string ZipCode { get; set; }
    
    ...
}
</code>
</pre>

The actual filtering is done with 1 method as an extension that can be called on any IQueryable

<pre>
<code>
addresses.Search("123 Fake Street");
</code>
</pre>

You can also get back the paths for your matches, so that you can do things like show on your UI what property of an object was matched to the query
<pre>
<code>
//on a collection
addresses.FindMatches("123 Fake Street");
//or on a single item
address.FindMatches("123 Fake Street");
</code>
</pre>

Features
==============================================================================================================================
Needle can do all these things:
* Filter a collection of annotated objects down to ones that match a search term.
* Get paths to your objects' matched properties.
* Conditionally match objects to a query.
* Modify what is queried before matching

Limitations
==============================================================================================================================
TODO

Documentation
==============================================================================================================================
The unit tests provided should get you started as they provide examples of Needle's features. There needs to be documentation or a tutorial, but this project isn't quite there yet.

To see classes decorated with Haystack attributes, just check **Testing\Needle\Models** for examples.

Then take a look at the unit tests which demonstrate the various features of the library. And if you decide to modify something, the extensive unit test collection in this solution should leave you confident you haven't broken anything!

Installation
==============================================================================================================================
It's just a class library, so you can both build the library and add the DLL as a reference, or you could include the entire Needle project (in which case you probably want to include the unit tests too, but you don't have to) in your solution and add it as a reference in your other projects.